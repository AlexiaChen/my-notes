椭圆曲线加密法是我们最强大的加密工具（之一），比其前辈要安全得多。但是......作为现代密码学中心的月球数学(Moon math)是如何工作的？

科幻技术的门外汉指南

互联网是一个非常公开的地方。它基本上是通过向任何听着的人发送信息，希望它能到达预定的收件人手中。

需要发送一个私人信息？其他人会得到数据的副本；你需要一个加密算法。

一个加密算法收到一个信息和一个加密密钥。

如果信息没有被加密，该算法将把它转化为难以辨认的废话，以保证数据的安全。

如果信息是加密的（并且密钥与编码相匹配），该算法将对其进行解码。

就把加密算法当作一个黑盒子，让我们把注意力放在加密密钥上。

任何拥有副本的人都可以接触到你的信息，所以我们需要确保它在你和你说话的人之间保持秘密。

那么......我们如何在公共场合创建一个共享的秘密？

第一个答案是Diffie-Hellman密钥交换，这是一个允许两个实体通过共享公共信息私下生成共享秘密的过程。

(从这里开始有数学，但很容易。你确实需要知道模块化算术，在链接的主题中有所涉及）。


Diffie-Hellman的关键在于下面的方程--特别是在于它的撤销是多么的困难。

模算术的问题是很难搞清楚数值在最大限度内循环了多少次。

![[Pasted image 20221023163205.png]]

假设你正在听一个Diffie-Hellman交换。你能够了解到。

n = 23
g = 5
g^a mod n = 4

我们知道g^a的余数是4......这个信息还不够。g^a=27吗？50? 73? 这简直有无限的选择。

一种方法是直接开始猜测。很快你就会发现a=4。但是对于足够大的数字，这可能要花很长时间。

在一个方向上的计算很容易，但撤销它却超级困难。我们把这些类型的函数称为陷阱门函数。

陷阱门函数构成了强加密的基础。

首先，Diffie-Hellman围绕模算术建立了一个协议。

接下来，RSA在这些想法上进行了扩展，围绕大数的因式分解建立了一个协议。

不幸的是，我们开始在解决这两个问题上变得越来越好。

综上所述，这就是我们发现自己所处的世界。

1) 密码学是关于使用公共通道创建共享秘密的。
2) 陷阱门函数为加密安全提供了基础
3）我们越来越善于解决旧的陷阱门函数的问题

这就是椭圆曲线密码学发挥作用的地方。椭圆曲线为更好的陷阱函数提供了所需的背景。

我们从一个椭圆曲线开始，定义如下。

![[Pasted image 20221023163553.png]]


我们将定义点操作，以利用曲线的独特形状和水平对称性。

形状：通过两点画出的直线会与曲线相交一次（而且只有一次）。

对称性：曲线总是存在于X轴对面的同一个地方。

![[Pasted image 20221023163623.png]]

 如果你足够注意，你已经可以看到陷门功能开始形成了。

需要提示吗？模运算很难撤销，因为你无法知道数值在最大值（n）上循环了多少次。1次迭代与1000次是没有区别的。

这就是我们要建立的点运算，但首先我们需要准备我们的工作空间。

在其目前的状态下，椭圆曲线是无限的。在x=1和x=2之间存在多少个值？这些值能有多大？


我们要对我们的曲线进行两个操作。

- 忽略所有x带有小数点的数值（只有整数）。
- 在曲线周围创建最大和最小的边界，折叠任何超出边界的部分（类似于模运算）。

![[Pasted image 20221023163809.png]]

离散域仍然保留了实现点操作所需的属性。

最重要的是，这个域保留了水平对称性（跨越X轴的对称性）。看看吧。

![[Pasted image 20221023163859.png]]

事实上，这些有限域中的点运算与椭圆曲线中的点运算几乎完全相同

每个点运算都会在两点之间创建一条线，一直持续到与另一个点相交。然后只要翻过X轴，找到对称的点就可以了。

![[Pasted image 20221023163932.png]]

在点的操作过程中，如果我们的线移动到我们所设定的范围之外，我们就简单地将线包起来。

你玩过 "小行星 "游戏吗？同样的想法：如果你移出屏幕，你只是以同样的轨迹重新出现在另一边。

计算一个点加点的次数是一个叫做椭圆曲线离散对数函数的过程；事实证明，这个函数是非常难解的。

事实上，除了猜测和检查，并没有更好的方法。

就像Diffie-Hellman系统一样，我们可以建立一个基于椭圆曲线的系统，使用这个单向函数来创建一个共享秘密。

Diffie-Hellman使用一个素数最大值（n）、一个基础公共基数（g）和一个私钥（a或b）来生成一个共享秘密。

椭圆曲线系统是（可以）通过选择一个素数作为最大值，一个曲线方程和曲线上的一个公共点来定义的。

私钥是一个数字PRIV，公钥是公共点与自身PRIV倍的点。

在比较椭圆曲线和Diffie-Hellman（和RSA）密码学时，我们必须比较陷阱门函数。

我们在因式分解方面取得了进展，改进了我们的解算过程并提高了计算能力。Diffie-Hellman（和RSA）正变得越来越不安全。

 椭圆曲线离散对数函数？已经过去了~30年，仍然没有人有比猜测更好的东西。

结果是：对于相同大小的数字，解决椭圆曲线离散对数的难度明显高于因式分解。

Arjen Lenstra在《通用安全》中对其进行了最好的阐述

破解一个228位的RSA密钥需要的能量比烧开一茶匙的水还要少。破解一个228位的椭圆曲线密钥需要足够的能量来煮沸地球上所有的水。

[eprint.iacr.org/2013/635.pdf](https://t.co/KCmosFDBSG)

![[Pasted image 20221023164323.png]]

 密码学是对通过公共渠道传输私人数据的追求。唉，我们生活在一个人类的世界里；人类不可避免地要试图闯入秘密。

首先，Diffie和Hellman（及Merkle）给了我们一个工具；一个正在老化的工具（很快）。

幸运的是，我们有椭圆曲线!