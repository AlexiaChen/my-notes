这个是未来规划，优化PoS共识的出块和提议部分的。现在还没有实现，但是说不定哪天就过时了。

合并(the merge)成功了，ETH代币是PoS! 随着矿工时代的结束，我们发现自己进入了一个新的元：MEV时代 [[ETH之MEV]]

以太坊面临的生存威胁指南......以及战胜它的计划

![[Pasted image 20221009162220.png]]

 > 从上图看，其实proposer和builder分开后，就是proposer只构建区块的外层（也就是共识层的数据），而区块的执行层（交易EVM层）则是builder负责。这样就分离了。
 
 从整体上看，一个以太坊交易是世界计算机的一个指令。交易是不可逆的和原子的（要么完全执行或要么失败）。

为了使用世界计算机，用户创建一个交易并将其发送到mempool。[[ETH的交易]]

mempool是一个待处理交易的公共数据库，每个交易都有自己的世界计算机的指令。

为了建立一个新的区块并使区块链（从而使世界计算机）取得进展(区块高度增加，状态变更持续)。以太坊节点从mempool中选择未决交易(pending transactions)。

这种方法有重要的好处（去中心化、透明、抗审查等），但也有一个关键的弱点：mempool的公共性质。

从这种设置来看，会带来加密货币的存在风险: MEV。

在2020年11月。@thegostep发布了 "Flashbots: 前沿的MEV危机"，并向社区介绍了最大可提取价值（MEV）。

在其最基本的化身中，MEV是一种套利形式。[[ETH之MEV]]


想象一下，一个机器人正密切关注着mempool上的pending txns。突然，一个有非常非常大的 ETH代币市场购买行为，这个非常大额的pending txn出现。

这个机器人知道这个pending txn将提高ETH代币的价格，机器人就会迅速买入ETH代币，等待这个txn，然后立即卖出它。

结果是:

MEV机器人--在巨大的txn推动了ETH代币价格上涨之前买入，之后立即卖出，锁定了利润。

鲸鱼(Whale)--提前露了一手，由于MEV机器人的存在，不得不以更高的价格购买ETH代币。

该机器人从鲸鱼那里提取了价值。

这个例子也许是最基本的MEV类型；从这里开始，事情很快就变得很奇特。

虽然MEV是一个非常多样化的类别，但有一个共同的贯穿线。MEV是拥有特权知识或访问系统的参与者所能获取的价值。[Haym 在 Twitter: "(1/21) What exactly IS MEV? How should you understand it? Let’s dive into its deep history, the current context and the exciting future ahead!" / Twitter](https://twitter.com/SalomonCrypto/status/1537908651112878085)

在我们的例子中，这包括对mempool的详细了解和操纵交易顺序的能力。机器人使用这些杠杆来提取价值。

但如果你不需要这些间接的杠杆呢？如果你可以自己建立区块呢？

一个以太坊节点是一台负责操作世界计算机和推进区块链的计算机。(在权益证明下）当一个区块提议者（随机选择）向网络提交一个新区块时，区块链就会取得进展

首先他们需要建立该区块

构建区块的最天真的方法是在mempool中扫描具有最高优先级费用的txns。每个txn按降序挑选，直到块被填满。

一个不太天真的节点可能会注意到一些机会，因为天真节点的构建。

还记得我们巨大的ETH代币购买吗？也许没有人注意到，所以当block proposer节点正在建立一个区块时，节点（block proposer）可以滑入一个txn以捕获套利。

或者，也许有人注意到了，并提交了套利的txn，而节点(block proposer节点)可能只是决定忽略这个txn，并把自己的txn放进去。

节点(nodes)在构建区块时不必尊重mempool；每个节点都能根据自己的需要选择txns。

一些节点将建立基础区块，其他节点将发挥更积极的作用。

有几个会比其他人好得多。

考虑一下更好地构建区块的意义。让我们想象一下2个节点：天真的区块建造者（NB）和MEV区块建造者（MB）。

- NB和MB将有相同的成本和机会来建造区块
- MB将比NB获得更多的收益
- MB的股份将比NB的股份增长更快。

截止到昨天，以太坊是一个权益证明链。

在PoS链上，一些节点（可以）比其他节点赚得更多，这意味着什么？

集中化是不可避免的。

集中化是 以太坊的反对意见。世界计算机是建立在一个单一的核心原则上：去中心化。

从去中心化中产生可信的中立性。从可信的中立性带来全球主导地位。

 就其本质而言，区块构建总是会奖励那些拥有最多资源的人。更快的连接、更好的算法和更聪明的人总是会超过普通的区块建造者。

与其说是公平竞争，不如说是把专业人员送进大联盟。

这就是一个区块的样子。在最高级别，它可以被认为是有3个部分：管理、共识和执行。

一个节点必须提出一个包含所有3部分的新区块......但节点没有理由必须建立整个区块。[[ETH的PoS区块]]

Flashbots的团队给了我们一个愿景：高度专业化的区块建设者。每个人都将是一个资源丰富的专家，尽可能积极地寻找MEV

他们将竞争建造最有吸引力的区块，希望下一个提议的节点选择他们的区块。


第一阶段：mev-geth，它为区块建造者提供了一个私人通道，以发送txn捆绑/区块给即将提出建议的节点。

与其自己寻找MEV，这些节点可以访问该通道并挑选最高利润的机会。

第二阶段：mev-boost，它适应了mev-geth的股权证明，并通过创建一个双面市场来扩展它。

任何节点都可以访问mev-boost以获得额外的MEV收益，任何区块建设者都可以提交捆绑。

这种新的架构允许有令人难以置信的好处。

- 节点可以平等地访问MEV
- 区块构建者可以获得更多的捆绑物/区块
- 区块构建者可以实现专业化和集中化，而不会影响以太坊的去中心化。

mev-boost是解决这个问题的一大步，但它仍然依赖于通过Flashbots的集中化和一些隐含的信任假设。

因此，Flashbots的最终目标是将自己直接折叠到 以太坊。世界计算机的终局是Enshrined PBS，也就是proposer和builder分离。

mev-boost是一个额外的软件，可以在以太坊的基础上栓住PBS。

但长期计划是通过将其纳入核心协议规范，将其纳入世界计算机。[[ETH之MEV]]

因此，我们正在规划一条走向去中心化的路线。以太坊区块生产的中心化；MEV的竞争性游戏转变为所有节点的公平访问。https://vitalik.ca/general/2021/12/06/endgame.html