# 什么是预言机

#### 预言机是什么

11 月 6 日，在中国人民银行发布的《区块链能做什么？不能做什么？》的报告中，是这样对预言机定义的。

区块链外信息写入区块链内的机制，一般被称为预言机 (oracle mechanism) 。

预言机的功能就是将外界信息写入到区块链内，完成区块链与现实世界的数据互通。它允许确定的智能合约对不确定的外部世界作出反应，是智能合约与外部进行数据交互的唯一途径，也是区块链与现实世界进行数据交互的接口。

听上去很难理解，我们举例来说。

大家会很形象的把公链比作操作系统（Windows、IOS、安卓），DAPP 类比的话就是 APP，那么预言机可以形象的比做 API 接口。API 是一组定义、程序及协议的集合，通过 API 接口实现计算机软件之间的相互通信。

这样类比虽然不准确，但意思就是预言机是区块链和现实世界之间的纽带，可以实现数据互通的工具。

#### Oracle为什么被翻译成预言机

跟别人提起预言机，很多人的第一反应都是预测市场，预言机这个名字确实容易想到预测。

Oracle 最初是来源于古希腊宗教，意为“神谕、先知、预言”。而在互联网领域，预言机（英语：oracle machine），又称谕示机，是一种抽象电脑，用来研究决定型问题。可以被视为一个多了个黑盒子（预言者）的图灵机，这个黑盒子的功能是可以在单一运算之内解答特定问题。

也许你会好奇这跟甲骨文公司有什么关系吗？其实没有关系。

Oracle 在中国叫甲骨文公司的原因可能是另一个故事。在中国商朝晚期，王室把在动物骨骼或龟甲上做占卜记事的文字叫甲骨文，甲骨文被英译为 Oracle bone script，后来 Oracle 公司到中国中译为了甲骨文公司。（很有道理的猜测 哈哈哈）

#### 区块链为什么需要预言机

区块链是一个确定性的、封闭的系统环境，目前区块链只能获取到链内的数据，而不能获取到链外真实世界的数据，区块链与现实世界是割裂的。

一般智能合约的执行需要触发条件，当智能合约的触发条件是外部信息时（链外），就必须需要预言机来提供数据服务，通过预言机将现实世界的数据输入到区块链上，因为智能合约不支持对外请求。

具体原因是这样的。区块链是确定性的环境，它不允许不确定的事情或因素，智能合约不管何时何地运行都必须是一致的结果，所以虚拟机（VM）不能让智能合约有 network call（网络调用），不然结果就是不确定的。

也就是说智能合约不能进行 I/O（Input/Output，即输入/输出），所以它是无法主动获取外部数据的，只能通过预言机将数据给到智能合约。

我们通过一个例子来说明一下。

假设现在我被关进了一个小黑屋里（不要多想，只是例子），我对外面的世界发生了什么一无所知，不知道外面是否有人，即使呼叫也没有人回应，而我知道外界信息的方式，只有外面的人在门口把他看到的听到的都告诉我，我才可以得知。

例子虽然不太恰当，但智能合约就像这个例子中的我一样，它无论何时何地，都无法主动向外寻求信息，只能外部把消息或数据给到里面。而预言机就是这个在外面输送消息和数据的人。

好像这么看来，智能合约并不是很智能呀，是的，智能合约其实是完成的不智能的事情，即写好了条件和结果，当给它条件的时候，就可以触发，但也不会马上执行，还需要合约相关的人进行私钥签署才可以执行。

所以，网上很多文章其实都有水分，比如智能合约某个时间或者触发某个条件就可以自动执行之类的，只能说这样的句子在逻辑上可能是有问题的。关于预言机的很多文章也有水分，描述的并不准确。

好了，上面就是区块链为什么需要预言机，因为智能合约无法主动去获取链外的数据，只能被动接受数据。

####  预言机怎么解决这个问题

![[Pasted image 20220812163136.png]]

这是理想中预言机的工作流程，即用户的智能合约把请求给链上 Oracle 合约，通过链下的 API 接口获得外部数据，更确切的说是外部把数据给链上的 Oracle 合约，然后 Oracle 合约再把数据给用户的智能合约。

或许很难理解，因为在互联网中，调用数据是非常容易的，只需要在程序中写调用的代码就可以了。但是区块链与外部世界的数据交互，确实不能进行这样的操作。

#### 预言机的应用场景有哪些

预言机作为区块链与现实世界进行数据交互的桥梁，应用场景非常多，可以说一切需要与链下进行数据交互的DApp都需要预言机。比如金融衍生品交易平台、借贷平台、快递追踪/IoT、稳定币、博彩游戏、保险、预测市场等等。

我们还是举例来说。

先说最近币圈比较火热的博彩游戏为什么需要预言机。博彩游戏的核心是不可预测、可验证的随机数，从而决定赌注的最终结果，但是在链上是无法生成随机数的或者说在链上的随机数是可以被预测和破解的，这时候就需要预言机从外部给智能合约安全的、不可预测的随机数。

现在的大多数博彩游戏都是在链上生成随机数，很容易被预测和破解，导致资产被盗，大家有兴趣的可以去看一下 DApp 被盗的相关研究报告，很多因为随机数问题被盗的。比如 BetDice、Dice2.Win。

如果大家很感兴趣，可以看一下我男神 DOS Network 创始人 jonny 关于《智能合约中的随机数》的分享。PPT链接： [https://zhuanlan.zhihu.com/p/50219222](https://zhuanlan.zhihu.com/p/50219222)

其实，早在 Fomo3D 这个游戏出来之后，以太坊的 Team Leader 就在推特上说过链上是无法生成随机数的。Dear devs… you cant generate random numbers on chain！

我们再来看一个关于快递追踪的例子。

假设当我通过某个 DApp 购物平台购买某件物品快递过来的时候，真实世界中的快递寄送或到达信息，就可以通过 Oracle 把数据传递到链上，然后触发链上的智能合约，我用自己的私钥确认收到了快递，并完成付款。

大家发现了吗？这里的智能合约不能自动执行，而是需要我用自己的私钥进行确认，智能合约保证的是没有第三方机构做担保和资金周转（比如支付宝），这就是智能合约的价值。

#### 目前的预言机项目

- Oraclize
- ChainLink
- DOS Network


## 预言机的设计

[【转】《精通以太坊》预言机 | 登链社区 | 区块链技术社区 (learnblockchain.cn)](https://learnblockchain.cn/article/589)

[深入预言机设计- 解析Oraclize和Chainlink | 登链社区 | 区块链技术社区 (learnblockchain.cn)](https://learnblockchain.cn/article/808)


## ChainLink与只能合约

[Chainlink在智能合约中的77种应用方式（一） | 登链社区 | 区块链技术社区 (learnblockchain.cn)](https://learnblockchain.cn/article/3147)
[Chainlink预言机在智能合约中的77种应用方式（二） | 登链社区 | 区块链技术社区 (learnblockchain.cn)](https://learnblockchain.cn/article/3157)
[Chainlink预言机在智能合约中的77种应用方式（三） | 登链社区 | 区块链技术社区 (learnblockchain.cn)](https://learnblockchain.cn/article/3184)



