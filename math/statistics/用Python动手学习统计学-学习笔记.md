
## 需要的python工具

- numpy
- pandas
- scipy

- matplotlib
- seaborn

## 统计学基础

### 统计学

- 统计学的目标 1. 描述现有数据（描述统计）  2. 估计未知数据（使用现有数据推断未知数据）（统计推断）
- 样本，现有数据
- 总体，包含现有数据也包含未知数据的全部数据集合

### 获取样本的过程

- 随机变量，根据随机法则变化的量叫做随机变量
- 样本值，由随机变量得到的具体数值叫样本值
- 抽样，从总体中获取样本叫做抽样
- 随机抽样/简单随机抽样。随机选择总体中各个元素的方法叫作随机抽样
- 样本容量，样本的大小或现有数据的个数叫作样本容量
- 普查，调查完整的总体叫做普查
- 抽样调查，只调查总体的一部分

### 抽样过程的抽样描述

- 概率，一般用P表示，获得某个数据的概率为P(某个数据)， 比如 P(1 < 体长 < 2) = xxx
- 概率分布，表示随机变量与概率之间的关系，有时直接称为分布。
- 服从某个概率分布，当某个数据和某种概率分布相符时，我们说xx服从xx概率分布
- 总体分布，总体服从的概率分布

> 通过简单随机抽样从总体中获取1个样本的过程，可以看作获取1个服从总体分布的随机变量的过程。

- 无限总体，掷骰子这样的实验的结果范围无限大，就是无限总体。

### 描述统计基础

- 定量变量/数值变量，数值之间的差距所代表的意义是等价的。比如，鱼的体长，条数等数据都属于定量变量
- 离散变量，属于定量变量的一种，只取整数的数据。比如鱼的条数
- 连续变量，属于定量变量的一种，有小数点的数据。比如鱼的体长。体长这个数值，是不可能用精确地整数描述的，总会有后面小数位数的差距，都是四舍五入，模糊计算得到的。
- 分类变量，不能定量的数据。类似数据的种类，比如，鱼的种类，有鲤鱼，罗非鱼等等。

- 组，在定量变量中，把数值分为几个范围，这些范围就叫做组。
- 组中值，组中最大值和最小值之间的中间数值，比如 \[1.5, 2.5\) 这个组中值就是2

- 频数，某个数据出现的次数
- 频数分布，每个组中数据的频数排列
- 频率，频数占总数的比例

- 累计频数，把组从小到大排列，将频数相加，得到的和就是累计频数。比如求组3的；累计频数就是把组1和组2，组3的频数相加所得
- 累计频率，同上，只是累加的是频率
- 直方图，表示频数的分布

- 统计量，用于统计数据的值叫作统计量。抽样的目的是推断总体，所以需要先分析样本的特征，分析样本的特征一个是图表，一个是计算数据的统计量。
- 均值，就常用的统计量。一般被用来代表已知数据（样本）的值，也叫代表值
- 期望值，跟均值等价，实质是一样的，也是统计量。只是统计学中，更喜欢用期望值替代均值。符号记作$\mu$, 你可以把期望值理解为能够用于未知数据的均值
- 方差，用来表示数据与均值(期望值)之间相差多少。当期望值和数据之间相差较大时，它们就不能很好地代表数据了。方差小，数据正好处在均值附近。方差大，数据远离均值。符号记作 $\sigma^2$

> 只通过均值和方差未必能够准确把握数据形状，这时候还是需要借助画图，直方图这样的手段

### 总体分布的推断

在总体很小的时候，直接数数。但是在总体很大的时候，就不行了。

- 做假设，先假设总体分布呈现某一种分布。比如正态分布。这个比较看经验，选择的分布要与实际的数据不太差太多。比如你从你的样本中的数据，也发现了它服从某种分布，你才可以假设总体服从某种分布。

### 概率质量函数与概率密度函数

- 概率质量函数，在将数据作为参数时，所得的函数值(返回值)是概率的函数。比较复杂，实践中很少使用
- 概率密度，因为离散变量可以直接计算概率，而连续变量不能直接计算概率，所以用概率密度代替概率，可以把它看作用于连续变量的类似于概率的概念。

> 取概率密度在4到5的区间上的积分，基本等同于求4到5的区间上无数个概率密度的总和。毕竟是用于连续变量的工具。

- 概率密度函数。将数据作为参数时，所得函数值(返回值)是概率密度的函数。概率密度函数不要随意选择，不然无法符合总体分布。

- 正态分布。定义域是整个实数轴上的实数。均值附近的概率密度较大。数据距离均值越远，概率密度越小。概率密度的大小相对于均值左右对称。
- 参数（概率分布的参数），用于定义概率分布的值，概率分布的形状会随着参数的变化而变化。若将随机变量x，则正态分布的概率密度函数记为$N(x)$ 或 $N(x | \mu, \sigma^2)$，因为正态分布有两个参数，就是均值和方差

> 根据中心极限定理证明，很多样本呈现正态分布，正态分布确实方便计算，但是也不能死板套用，有时候也会使用二项分布或者泊松分布。二项分布适用于硬币正反面这种结果只有两种形式的数据。泊松分布多用于个数，次数等只取大于0的整数的数据。
> 
> 很多统计学的书籍会花费大量时间来讲解概率分布的种类及性质，因为概率分布的种类可以直接代表总体分布的类型。在统计学分析中，人们会将常用的分布用于总体分布，但是如果不在一定程度上假设概率分布的种类，分析就很难继续进行下去，用错了分布，数据分析就会偏离实际。

如何推断总体分布呢？两步，第一步确定分布的种类，第二步是估计分布的参数。估计分布参数可以用python来计算。

如何估计分布的参数呢？ 估计参数最直接的思路就是把样本的统计量看作是总体分布的参数。但是这个估计出来的可能也会有误差，所以误差也要考虑进行。

### 统计量的计算

- 均值，一般是算术平均值

$$
\mu = \frac{1}{N} 
\sum_{i=1}^{N}x_i
$$

- 期望值，本质上就是平均。$x_i$ 表示样本中的具体数值， $p_i$是取值的概率。

$$
\mu = \sum_{i=1}^{N} P(x_i) \cdot x_i
$$

> 总体均值和样本均值不一样，总体均值是未知的，样本均值是已知的，但是总体均值与样本均值会有差距，但是不会偏离。也就是说，两者之间出现正或负的微小差距的情况基本各占一半，当扩大样本容量，样本均值会逐渐接近总体均值。

- 样本方差

$$
\sigma^{2} = \frac{1}{N} 
\sum_{i=1}^{N} (x_i - \mu)^{2}
$$

$$
\sigma^{2} = \sum_{i=1}^{N} P(x_i) \cdot (x_i - \mu)^{2}
$$

其中$x_i - \mu$叫偏差，偏差的平方$(x_i - \mu)^{2}$ 一般用来表示数据与期望值（均值）之间的距离。所以方差公式结合前面的均值/期望值的公式模板套用，本质上方差就是数据与期望值之间的距离的均值。

- 无偏方差，因为样本方差和总体方差之间有偏离，无偏方差就是为了修正这个偏离而出现的。无偏方差比样本方差更大

$$
\sigma^{2} = \frac{1}{N - 1} 
\sum_{i=1}^{N} (x_i - \mu)^{2}
$$

- 标准差，一般就是对方差取平方根得出，这里的方差是无偏方差。

$$
\sigma = \sqrt{\sigma^{2}} = \sqrt{\frac{1}{N - 1} 
\sum_{i=1}^{N} (x_i - \mu)^{2}}
$$

### 概率论基础

- 集合，这个从小学到大。不赘述。
- 元素，集合里面的元素。

- 样本点，可能发生的实验结果。符号记作 $\omega$ 例子：掷色子的样本点为1，2，3，4，5，6
- 样本空间，样本点的总体集合。符号记作 $\Omega$， 例子，掷色子的样本空间是{1,2,3,4,5,6}
- 事件，样本空间的子集，事件有交事件也有并事件。
- 基本事件，只有一个样本点组成且不可再分解的事件。例子，掷色子的基本事件，{1},{2},(3),{4},{5},{6}
- 复合事件，含有多个样本点且可以再分解为多个基本事件的事件。例子，掷色子得偶数{2,4,6}为一个复合事件，同理，奇数也一样
- 空事件，不含任何样本点的事件

- 概率的公理化定义,只要满足以下三个条件，就可以称为概率
    - 对于所有事件A， $0 <= P(A) < 1$
    - $P(\Omega) = 1$
    - 对于互斥事件 $A_1, A_2,..., P(A_1 \cup A_2 \cup ...) = P(A_1) + P(A_2) + ...$

- 概率是什么？可以简单认为就是频率的极限，因为只有无穷无尽地实验下去，才可以知道精确地概率。

> 比如掷色子，1/6的概率表示，扔6次，大概就会有一次出现你期望的结果。但是也有可能扔6次，看不到你期望的结果，只有不停地扔下去，你的实验结果才可以逼近1/6。

> 注意，贝叶斯学派对于概率的解释不是这样的，他们任务概率是主观，个人主观决定的，所以有一种统计学叫贝叶斯统计学，依赖贝叶斯定理。

- 条件概率，以事件B为前提条件，事件A发生的概率叫做条件概率，记作:

$$
P(A | B) = \frac{P(A \cap B)}{P(B)}
$$

- 独立事件，当$P(A \cap B) = P(A) \cdot P(B)$成立时

### 随机变量与概率分布

- 随机变量与样本值。 $P(X = x)$， 其中X就是随机变量，x是随机变量的具体值，也就是样本值。
- 离散型概率分布与概率质量函数
$$
P(X = x_i) = f(x_i), i = 1,2,3,...
$$

此时，称X服从离散型概率分布，称函数$f(x_i)$为概率质量函数。

$$
\sum_{i = 1}^{\infty} f(x_i) = 1, and f(x_1) >= 0
$$

- 概率密度

$$
P(x <= X <= x + \Delta x)
$$

其中，当$\quad \Delta x \to 0$, 可由$P(x) \cdot \Delta x$计算出概率，P(x)就是x的概率密度

- 连续型概率分布与概率密度函数

$$
P(a <= X <= b) = \int_{a}^{b} f(x) dx
$$

此时，称X服从连续型概率分布，函数$f(x)$为概率密度函数。 连续型随机变量X，取得特定值的概率永远为0，所以都是用积分求落在某范围内的概率。

$$
\int_{-\infty}^{+\infty} f(x)dx = 1 \quad and \quad f(x) >= 0
$$

> 离散型和连续型其实无非就是加法和积分的区别，二者其实都是在做同一件事情

- 正态分布的概率密度函数

$$
N(x | \mu, \sigma^2) = \frac{1}{\sqrt{2 \pi \sigma^2}}e^{-\frac{(x - \mu)^2}{2 \sigma^2}}
$$

可以用随机变量X，表明随机变量X服从XX分布，比如 $X \sim N(x| \mu, \sigma^2)$

- 使用概率密度计算期望值的方法。

> 前面的期望值都是针对离散的数据进行计算的，所以现在学习连续的数据，怎样算期望/均值

$$
\mu = \int_{-\infty}^{+\infty} f(x) \cdot xdx = \int_{-\infty}^{+\infty} N(x| \mu,\sigma^2) \cdot xdx
$$

## 用Python进行数据分析

### 使用Python进行描述统计 - 单变量

```python
import numpy as np
import scipy as sp
# 精度设置
%precision 3

fish_data = np.array([2,3,1,6,...])

# 计算数据总和
sp.sum(fish_data)

# 计算样本容量
len(fish_data)

# 计算期望/均值
N = len(fish_data)
sum_value = sp.sum(fish_data)
mu = sum_value / N
# or
sp.mean(fish_data)

# 计算样本方差
sigma_2 = sp.sum((fish_data - mu) ** 2) / N
# or
sigma_2 = sp.var(fish_data, ddof = 0)

# 计算样本的无偏方差
sigma_2 = sp.sum((fish_data - mu) ** 2) / (N - 1)
# or
sigma_2 = sp.var(fish_data, ddof = 1)

# 计算标准差
sigma = sp.sqrt(sigma_2)
# or
sigma = sp.std(fish_data, ddof = 1)

# 标准化，把数据集合的均值转化为0，把数据集合的标准差(方差)转换为1
standard = (fish_data - mu) / sigma

# 最大值和最小值
sp.amax(fish_data)
sp.amin(fish_data)
# 中位数, 中位数对于极端值带来的影响更具有抵抗性
sp.median(fish_data)

# 四分位数，把数据按照升序排列，处在25%和75%位置的数
from scipy import stats
stats.scoreatpercentile(fish_data, 25)
stats.scoreatpercentile(fish_data, 75)
```

### 使用python进行描述统计 - 多变量

在进行多变量分析之前，需要了解整洁数据。

- 整洁数据，类似于数据库的二维表格，每个变量构成一列，每个单元格代表一个数值，每项观察构成一行，每种类型的观察分析构成一整张表格
- 杂乱数据，无法分析，整洁数据以外的都是杂乱数据，把杂乱数据变为整洁数据所花费的时间和精力超出很多人的想象

> 给别人分析之前，最好给整洁数据

```python
import pandas as pd
import scipy as sp

%precision 3

# pandas的数据帧就是一张二维表格，只是这张二维表格不一定是整洁数据，
multi_fish_data = pd.read_csv("path.csv")
print(multi_fish_data)
# 可以像类似数据库的groupby操作，假设表格中有一列叫种类 species
group = multi_fish_data.groupby("species")
print(group.mean())
print(group.std(ddof = 1))
# 得出最重要的几个统计量
group.describe()
```


### 基于matplotlib和seaborn的数据可视化