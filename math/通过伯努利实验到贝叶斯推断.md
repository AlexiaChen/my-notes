
## 通过伯努利实验到贝叶斯推断

  

在之前的笔记中，我们提到过了贝叶斯推断，利用贝叶斯规则进行迭代，不停地以后验概率更新先验概率。所以我们需要再举个具体的数值例子来引入新的东西。这个例子是抛硬币。

  

首先，我们考虑两个概念： 参数(parameters)和模型(models)。一个参数可能在这个例子中就是一个不公平硬币的重量，我们可以把它记作$\theta$。 因此，$\theta = P(H)$ 这个就可以描述当抛硬币后硬币将会正面朝上的概率分布。为什么是一个概率分布呢？毕竟这个硬币重量（权重）是一个变量，它的值是不确定的，所以我们可以用一个概率分布来描述。

  

至于模型其实就是用数学的手段编码这次抛硬币实验的具体方法，当然在这个实例中，抛硬币可以看作是一个伯努利实验。所以模型就是，伯努利实验。抛一次硬币，就是一次伯努利实验。

  

### 伯努利实验(Bernoulli Trial)

  

一次伯努利实验就是一次随机实验，它只有两种结果，成功或者失败。成功的概率随着实验进行应该每次都是绝对相同的，成功的概率只会被$\theta$影响，也就是硬币的重量（权重），这个参数的值是在0到1之间的， 记作 $\theta \in [0,1]$。所以我们可以用一个伯努利分布来描述这个实验。

  

这样我们进行多次硬币翻转实验（重复多次伯努利实验），然后你就可以看到一个结果序列（正面或者反面的序列），把这个序列记作数据$D$。

  

由此，有一句话会问"在8次实验中，3次正面朝上的概率是多少？如果是一个公平的硬币，也就是 $\theta = 0.5$ "

  

所以，模型会帮助我们在给定参数 $\theta$ 的值的情况下，来分析看到这个数据 $D$ 的概率，这个记作 $P(D|\theta)$。

  

然而，你仔细思考了一下，其实我们实际感兴趣的是一个与之相似的问题 “给定一串实验后的硬币正反面的序列，硬币是公平还是非公平的概率是多少？”  ， 你仔细思考一下是不是，毕竟我们不知道硬币的重量是多少，我们只知道实验结果，也就是硬币的正反面的序列。我们都是通过实验数据，也就是看到的事实来预测推算一个未知的参数的值。

  

因此，实际上我们感兴趣的是 $\theta$ 值的概率分布，也就是 $P(\theta|D)$，也就是在知道 $D$ 的条件下，$\theta$ 的概率分布。注意，这个是与 $P(D|\theta)$ 相反的，不是同一个东西。所以我们应该如何计算和转换这两种不同的概率呢？

  

### 用贝叶斯规则来进行贝叶斯推断

  

先列出贝叶斯推断公式:

  

$$

P(\theta|D) = \frac{P(D|\theta)P(\theta)}{P(D)}

$$

  

其中：

  
  

- $P(\theta)$ 是先验概率(Prior)，也就是在看到数据 $D$ 之前，参数 $\theta$ 的概率.这个需要凭借经验，比如你看到的硬币是不是形状非常不规则，不规则当然就是非公平的硬币，如果看不出来，你可以认为是一个公平的硬币，也就是 $\theta = 0.5$，那么你就可以认为 $P(\theta) = 0.9$。

- $P(\theta|D)$ 是后验概率(Posterior)，也就是在知道数据 $D$ 的情况下，参数 $\theta$ 的概率. 比如8次实验，4次正面朝上，那么你就应该暂时认为这个硬币是公平的了。

- $P(D|\theta)$ 是似然概率(Likelihood)，也就是在知道参数 $\theta$ 的情况下，数据 $D$ 的概率. 比如我们知道硬币是不公平的，那么我们就知道在特定实验次数下，正面朝上的次数大概可能会是多少

- $P(D)$ 是边缘概率(Marginal)，也就是数据 $D$ 的概率，也算证据. 这个是一个归一化的常数，用来保证后验概率的和为1。它是一个累计概率，也就是所有可能的 $\theta$ 值产生的数据 $D$ 的概率的和。

  
  

整个贝叶斯推断的目标就是给我们提供一个理性和数学化的方法来更新我们的信念，也就是参数 $\theta$ 的值。我们可以通过这个方法来不断地迭代，不断地更新我们的信念，直到我们认为我们的信念已经足够准确了。这里面最核心的就是用前一次的后验概率作为下一次的先验概率，然后再用新的数据来更新后验概率。。因此贝叶斯推断允许我们持续地根据新数据来更新我们的信念。，这样不停地应用贝叶斯规则。

  

### 硬币翻转实例

  

这回是代入具体数值。这个实例中，我们会考虑一个未知公平性的一枚硬币的多次翻转。我们将使用贝叶斯推断来在多次翻转实验数据的情况下，更新我们对这枚硬币公平性的信念。这枚硬币是公平的，也就是 $\theta = 0.5$，但是我们必须在随着实验次数的进行才可以验证这个事实。最开始，我们没有对这个硬币的公平性的先验信念，所以我们可以对 $P(\theta)$ 取任意值，比如 $P(\theta) = 1$。

  

用统计学的语言来说，我们将要执行一个N次伯努利实验，假设我们的硬币是公平的，也就是 $\theta = 0.5$。我们将使用均匀概率分布作为先验概率（毕竟我们最开始对硬币的公平性还不清楚）。这个就表明，$\theta$ 在任意值 $[0,1]$ 上的概率是相同相等的, 也就是说，我们对于 $\theta$ 没有任何偏见，当然这个在数学上也有便利性，这个后面我会提到。